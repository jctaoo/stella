---
import ArticleLayout from "@/layouts/Article.astro";
import { getCollection, type CollectionEntry } from "astro:content";
import type { GitTime } from "@plugins/remark-modified-time";
import type { ReadingTime } from "@plugins/remark-reading-time";

export async function getStaticPaths() {
  const posts = await getCollection("posts");
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: post,
  }));
}
type Props = CollectionEntry<"posts">;

const post = Astro.props;

const { title: pageTitle, tags, category } = post.data;
const { Content, remarkPluginFrontmatter } = await post.render();

const gitTimes = remarkPluginFrontmatter.gitTimes as GitTime;
const readingTime = remarkPluginFrontmatter.readingTime as ReadingTime;
---

<ArticleLayout frontmatter={{ title: pageTitle, gitTimes, readingTime, tags, badge: category }}>
  <Content />
</ArticleLayout>
