---
import MainLayout from "@/layouts/main.astro";
import { getCollection, type CollectionEntry } from "astro:content";
import { Badge } from "@/components/ui/badge";
import { getLastModified } from "@/utils/lastModified";

const posts = await getCollection("posts");
const pageTitle = "Posts";
---

<MainLayout content={{ title: pageTitle }}>
  <div class="min-h-screen bg-background">
    <div class="container mx-auto max-w-4xl p-6 md:p-12 space-y-8 pt-16 md:pt-12">
      <header class="space-y-2">
        <h1 class="text-4xl font-light tracking-wide text-foreground">文章</h1>
        <p class="text-muted-foreground">分享技术思考与实践经验</p>
      </header>
      
      <div class="space-y-6">
        {
          posts.map((post) => (
            <article class="group">
              <a href={`/posts/${post.slug}/`} class="block space-y-3 p-6 rounded-lg hover:bg-muted/50 transition-colors">
                <header class="space-y-2">
                  <div class="flex items-center gap-2">
                    {post.data.category && (
                      <Badge variant="secondary" className="text-xs">
                        {post.data.category}
                      </Badge>
                    )}
                  </div>
                  <h2 class="text-xl font-medium text-foreground group-hover:text-primary transition-colors">
                    {post.data.title}
                  </h2>
                </header>
                
                {post.data.abbr && (
                  <p class="text-muted-foreground text-sm leading-relaxed">
                    {post.data.abbr}
                  </p>
                )}
                
                <footer class="text-xs text-muted-foreground">
                  {getLastModified(post)}
                </footer>
              </a>
            </article>
          ))
        }
      </div>
    </div>
  </div>
</MainLayout>
