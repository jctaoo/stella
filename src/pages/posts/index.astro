---
import MainLayout from "@/layouts/main.astro";
import { getCollection, type CollectionEntry } from "astro:content";
import { Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import type { GitTime } from "@plugins/remark-modified-time";
import dayjs from "dayjs";
import { getLastModified } from "@/utils/lastModified";

const posts = await getCollection("posts");
const pageTitle = "Posts";
---

<MainLayout content={{ title: pageTitle }}>
  <main class="container mx-auto max-w-4xl p-6 space-y-6">
    <h1 class="text-3xl font-bold tracking-tight">{pageTitle}</h1>
    <div class="grid gap-4 sm:grid-cols-2">
      {
        posts.map((post) => (
          <a href={`/posts/${post.slug}/`} class="contents">
            <Card className="hover:shadow-md transition-shadow">
              <CardHeader>
                <div class="flex items-center gap-2">
                  {post.data.category && <Badge variant="secondary">{post.data.category}</Badge>}
                </div>
                <CardTitle className="mt-2">{post.data.title}</CardTitle>
              </CardHeader>
              <CardContent className="">
                {post.data.abbr}
              </CardContent>
              <CardFooter>
                <div class="text-sm text-muted-foreground">
                  {getLastModified(post)}
                </div>
              </CardFooter>
            </Card>
          </a>
        ))
      }
    </div>
  </main>
</MainLayout>
